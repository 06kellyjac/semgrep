rules:
- id: resetting-value
  patterns:
    - pattern-inside:
        - patterns:
           - pattern: |
              def $FUNC($X, ...):
                 ...
           - pattern: |
              lock($X)
              ...
    - pattern: |
        set($X)
        ...
  message: Resetting with default after value set
  languages: [python]
  severity: ERROR
